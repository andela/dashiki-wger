{% load i18n staticfiles %}

<link rel="stylesheet" type="text/css" href="{% static 'bower_components/datatables/media/css/dataTables.bootstrap.min.css' %}">
<script src="{% static 'bower_components/datatables/media/js/jquery.dataTables.min.js' %}" ></script>
<script src="{% static 'bower_components/datatables/media/js/dataTables.bootstrap.min.js' %}" ></script>
<script>
$(document).ready( function () {
    /* Make table sortable */
    $('#main_member_list').DataTable({
        paging: false,
        bFilter: true,
        bInfo : false
    });
});
</script>

{% if not show_gym %}
    <script>
        function compareMembers() {
            var selected = [];
            var new_url = "";
            $("input:checkbox[name=selected_member]:checked").each(function(){
                selected.push($(this).val());
            });
            for (var i=0; i < selected.length; i++) {
                if (i === (selected.length - 1)) {
                    new_url += selected[i];
                } else {
                    new_url += selected[i] + "-or-";
                }
            }
            window.location = "{% url 'gym:gym:compare' pk=gym_id %}" + new_url;
        }
    </script>
    {% if active %}
        <a href="{% url 'gym:gym:user-list-inactive' gym_id %}" class="btn btn-default btn-sm">Inactive Users</a>
    {% else %}
        <a href="{% url 'gym:gym:user-list' gym_id %}" class="btn btn-default btn-sm">Active Users</a>
    {% endif %}
    <a onclick="compareMembers()" class="btn btn-default btn-sm">Compare</a>
{% endif %}

<table class="table table-hover" id="main_member_list">
<thead>
<tr>
    {% for key in user_table.keys %}
        <th>{{ key }}</th>
    {% endfor %}
</tr>
</thead>
<tbody>
{% for current_user in user_table.users %}
<tr>
    <td>
        {{current_user.obj.pk}}
    </td>
    <td>
        <a href="{% url 'core:user:overview' current_user.obj.pk %}">{{current_user.obj}}</a>
    </td>
    <td>
        {{current_user.obj.get_full_name}}
    </td>
    <td data-order="{{current_user.last_log|date:'U'}}">
        {{current_user.last_log|default:'-/-'}}
    </td>
    {% if show_gym %}
    <td>
        {% if current_user.obj.userprofile.gym_id %}
            <a href="{{ current_user.obj.userprofile.gym.get_absolute_url }}">
            {{ current_user.obj.userprofile.gym }}
            </a>
        {% else %}
            -/-
        {% endif %}
    </td>
    {% endif %}
    <td>
        <input type="checkbox" name="selected_member" value="{{ current_user.obj.id }}"/>
    </td>
</tr>
{% endfor %}
</tbody>
</table>
